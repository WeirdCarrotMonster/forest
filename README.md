FOREST - place, where your servers grow.
========

1. Зачем
--------
Forest предназначен для упрощения (автоматизации) развертывания приложений на фреймворке django (а потенциально и других, но тестирования не проводилось).
2. Как
------
Forest автоматически создает базу данных, пользователя для неё и назначает ему права; настраивает uwsgi-fastrouter, запускает инстансы приложения, а так же может балансировать нагрузку и выполнять обновления базы.
3. Роли компонентов системы
---------------------------
1. Trunk:
основной компонент, присутствующий в каждой инсталяции - выполняет роль контроллера инстансов, позволяет пользователю добавлять, удалять и переносить их без необходимости взаимодействия с базой.
2. Branch:
компонент запуска инстансов приложения. Больше про него в общем-то сказать нечего.
3. Roots:
отвечает за создание базы. В будущем будет поднимать инстанс MySQL (или MariaDB) и самоорганизовывать репликацию, либо через master-slave, либо через galera cluster.
4. Air:
выполняет запуск uwsgi-fastrouter'а и добавление файлов ключей для известных адресов. В будущем - логгирование запросов, составление статистики.

4. Конфигурация
---------------
Типовая конфигурация представлена в settings.json. Подробнее о всех параметрах:

1) connections:

  Определяет адрес и порт, на котором слушает инстанс. 
  
2) settings:

  Базовые настройки инстанса
  
  name - уникальный параметр, идентификатор инстанса
  
  secret - секретный ключ, используемый для аутентификации запросов
  
  mongo_(host, port, user, pass) - настройки для соединения с MongoDB
  
  database - база данных, используемая лесом. По-умолчанию trunk, позволяет организовывать несколько независимых экосистем на одном MongoDB ReplicaSet
  
3) Настройки ролей:

3.1) air:

  keydir - директория с ключами для адресов. Должна содержать файл default.pem
  
  host - адрес, который будет слушать subscription server
  
  fastrouter - порт, который будет слушать subscription server (да-да, переименую, ладно)
  
3.2) roots:

  Содержит настройки для подключения к MySQL-серверу. Предполагается, что сервер по этому адресу доступен извне.
  
3.3) branch:
  
  host - адрес, на котором будут запускаться инстансы приложений
  
  keyfile - файл приватного ключа, по которому генерировался default.pem
  
  species - описание видов инстансов
  
5. Генерация файла ключей
-------------------------
Генерация приватного ключа

openssl genrsa -out private.pem

Генерация шаблона публичного ключа

openssl rsa -pubout -out default.pem -in private.pem
